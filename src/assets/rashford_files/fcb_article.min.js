"use strict";PULSE.app.templates["related-articles-list"]=_.template('<div class="related-articles__title"> <b><%= PULSE.I18N.lookup(\'label.content.related\') %></b> <%= PULSE.I18N.lookup(\'label.content.related.tothisstory\') %> </div> <ul class="related-articles__list"> <% _.forEach(articles, function(article) { %> <% articleTag = TEMPLATE_HELPER.getMediaTag(article.tags) %> <% isFeatured = TEMPLATE_HELPER.contentHasTag(article.tags, \'Feature\') %> <li class="related-articles__item"> <a href="<% if (article.hotlinkUrl) { %> <%= article.hotlinkUrl %> <% } else { %></a><%= URL_HELPER.generateUrl(\'text\', article.id, isFeatured ? \'featured\' : null, article.title) %><% } %>" class="related-articles__link" <% if (article.hotlinkUrl) { %> rel="noopener" target="_blank" <% } %>> <% if (article.subtitle) { %> <span class="related-articles__article-title"><%= article.subtitle %></span> <% } else { %> <span class="related-articles__article-title"><%= article.title %></span> <% } %> <% if (articleTag) { %><span class="related-articles__tag"><%= PULSE.I18N.lookup( articleTag ) %></span><% } %> <time class="related-articles__time"> <svg class="related-articles__time-icon icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/icn.svg#clock"></use></svg> <span class="visually-hidden"><%= PULSE.I18N.lookup(\'label.aria.clock\') %></span> <span class="related-articles__time-date"><%= TEMPLATE_HELPER.dateAge(article.publishFrom) %></span> </time> </a> </li> <% }) %> </ul>'),function(e,t,r){const a="article-modal__close--expanded";e.Article=function(e,t){const r=this;r.container=e,r.config=t||{},r.isModal=r.config.isModal||!1,r.socialShareElems=r.container.querySelectorAll(`.${CONSTANTS.JS_CLS_NAMES.SOCIAL_SHARE}`),r.articleFooterElem=r.container.querySelector(".js-article-footer"),r.pageBottomElem=r.container.querySelector(".js-article-bottom"),r.updatePublishTime(),r.observableElem=r.container.querySelectorAll("[data-observe]"),r.elementsToObserve=i.call(r),r.init()},e.Article.prototype.updatePublishTime=function(){const t=this.container.querySelector(".js-publish-date");if(!t)return;const r=Number(this.container.dataset.publishFrom),a=moment.tz.guess(),i=moment.tz(r,a),l="ja"===e.language?"MMMD日（ddd）ah.mm":"hh:mma dddd DD MMM";t.innerText=i.format(l)},e.Article.prototype.init=function(){l.call(this)},e.Article.prototype.removeScrollObserver=function(){const e=this;e.intersectionObserver&&e.intersectionObserver.disconnect()};const i=function(){const e=this,t=[];return t.push(e.articleFooterElem),t.push(e.pageBottomElem),t.concat(DOM_HELPER.nodeListToArray(e.socialShareElems)).concat(DOM_HELPER.nodeListToArray(e.observableElem))},l=function(){const e=this;e.intersectionObserver=new IntersectionObserver(t=>{t.forEach(t=>{t.target!==e.pageBottomElem?s.call(e,t):n.call(e,t)})},{threshold:.6});for(let t=0;t<e.elementsToObserve.length;t++)e.elementsToObserve[t]&&e.intersectionObserver.observe(e.elementsToObserve[t])},s=function(e){e.isIntersecting&&ANIMATION_HELPER.requestAnimationFrame(()=>{r.style.addClass(e.target,CONSTANTS.STYLE_CLS_NAMES.IS_VISIBLE)})},n=function(e){const t=this;t.isModal&&ANIMATION_HELPER.requestAnimationFrame(()=>{e.isIntersecting?r.style.addClass(t.config.controls.close,a):r.style.removeClass(t.config.controls.close,a)})};e.widgetInitialiser.addMultipleWidgetsByName("article",e.Article)}(PULSE.app,PULSE.app.common,PULSE.core),function(e,t){const r=function(){const r=this,a={url:e.apiPath.cms.text+"?"+t.url.buildQueryString({tagNames:r.tags}),method:"GET",callback:r.render,forceCallback:!0,target:r};t.data.manager.add(a)};e.RelatedArticles=function(e){const t=this;t.container=e,t.articleBody=document.querySelector(".js-article-body"),t.firstTitle=t.articleBody.querySelector("h1, h2, h3"),t.thirdParagraph=t.articleBody.querySelector("p + p + p"),t.firstParagraph=t.articleBody.querySelector("p");const r=e.getAttribute("data-additional-config"),a=document.querySelector(r);if(!a)return;t.currentArticleId=Number(a.getAttribute("data-article-id"));const i=a.getAttribute("data-tags")||"";t.tags=i.split(","),t.tags.push(CONSTANTS.TAGS.TYPE.NEWS.tag),t.init()},e.RelatedArticles.prototype.init=function(){r.call(this)},e.RelatedArticles.prototype.render=function(e){const r=this;if(!e.content||0===e.content.length)return;const a=function(e,t){return e.filter(e=>e.id!==t)}(e.content,r.currentArticleId);0!==a.length&&(r.container.innerHTML=TEMPLATE_HELPER.render({articles:a},"related-articles-list"),t.style.addClass(r.container,CONSTANTS.STYLE_CLS_NAMES.HAS_CONTENT),r.firstTitle||r.thirdParagraph?r.articleBody.insertBefore(r.container,r.firstTitle||r.thirdParagraph):r.firstParagraph&&r.firstParagraph.nextSibling&&r.articleBody.insertBefore(r.container,r.firstParagraph.nextSibling))},e.widgetInitialiser.addMultipleWidgetsByName("related-articles",e.RelatedArticles)}(PULSE.app,PULSE.core);